# Development Requirements Specification (DRS)
## RCMD (Rclone Commander)

**문서 버전**: 1.1
**작성일**: 2025-09-24
**업데이트**: 2025-09-24
**프로젝트 코드명**: RCMD
**문서 상태**: 개정판

---

## 📋 목차
1. [요구사항 개요](#요구사항-개요)
2. [기능 요구사항](#기능-요구사항)
3. [비기능 요구사항](#비기능-요구사항)
4. [시스템 인터페이스](#시스템-인터페이스)
5. [데이터 요구사항](#데이터-요구사항)
6. [보안 요구사항](#보안-요구사항)
7. [제약사항](#제약사항)
8. [우선순위 매트릭스](#우선순위-매트릭스)

---

## 요구사항 개요

### 1.1 프로젝트 목적
개인 클라우드 스토리지 서비스들을 통합 관리하는 오케스트레이션 플랫폼 구축
- **웹서비스**: 서버상의 로컬/리모트와 리모트 간 파일 작업
- **Electron 앱**: 사용자 PC와 리모트 간 파일 작업 (인증 불필요)

### 1.2 핵심 가치
- **통합 가시성**: 모든 클라우드 저장소의 통합 뷰
- **유연한 배포**: 웹서비스와 데스크톱 앱 동시 지원
- **호환성 보장**: rproxy가 rclone RC API와 동일 인터페이스 제공
- **실용적 기능**: 파일 전송, 백업, 동기화, 미리보기

### 1.3 사용자 페르소나
| 페르소나 | 설명 | 주요 요구사항 |
|---------|-----|-------------|
| 웹서비스 사용자 | 서버 기반 리모트 관리 | 인증, 권한 관리, 다중 사용자 |
| Electron 앱 사용자 | 개인 PC 파일 관리 | 인증 불필요, 로컬 우선, 직접 제어 |
| 시스템 관리자 | 서비스 운영 및 모니터링 | /status 페이지, 알림 설정 |

---

## 기능 요구사항

### 2.1 인증 및 권한 관리 (FUNC-AUTH)

#### FUNC-AUTH-001: 사용자 인증
- **설명**: JWT 기반 사용자 인증 시스템 (웹서비스 전용)
- **수락 조건**:
  - 웹서비스: 로그인/로그아웃 기능 필수
  - Electron 앱: 인증 불필요 (로컬 실행)
  - 토큰 갱신 메커니즘
  - 세션 타임아웃 처리
- **우선순위**: P0 (필수)

#### FUNC-AUTH-002: 리모트별 권한 제어
- **설명**: 사용자별 리모트 접근 권한 관리
- **수락 조건**:
  - 리모트별 읽기/쓰기 권한 설정
  - 권한 매트릭스 관리 UI
  - 실시간 권한 적용
- **우선순위**: P0 (필수)

### 2.2 리모트 관리 (FUNC-REMOTE)

#### FUNC-REMOTE-001: 리모트 목록 표시
- **설명**: 101개 리모트 실시간 상태 표시
- **수락 조건**:
  - 가상 스크롤링으로 대량 리모트 처리
  - 연결 상태 실시간 업데이트
  - 필터링 및 정렬 기능
- **우선순위**: P0 (필수)

#### FUNC-REMOTE-002: 리모트 상세 정보
- **설명**: 각 리모트의 상세 정보 조회
- **수락 조건**:
  - 용량 정보 (사용/전체)
  - 파일 개수 통계
  - API 사용량 및 제한 정보
- **우선순위**: P1 (높음)

### 2.3 파일 시스템 작업 (FUNC-FILE)

#### FUNC-FILE-001: 파일 브라우징
- **설명**: 리모트 내 파일/폴더 탐색
- **수락 조건**:
  - 지연 로딩으로 대량 파일 처리
  - 파일 타입별 아이콘 표시
  - 경로 이동 네비게이션
- **우선순위**: P0 (필수)

#### FUNC-FILE-002: 파일 작업
- **설명**: 기본 파일 작업 수행
- **수락 조건**:
  - 복사/이동/삭제 작업
  - 진행률 표시
  - 배치 작업 지원
- **우선순위**: P1 (높음)

#### FUNC-FILE-003: 파일 미리보기
- **설명**: 미디어 파일 미리보기
- **수락 조건**:
  - 이미지 썸네일 생성
  - 비디오 스트리밍
  - 텍스트 파일 뷰어
- **우선순위**: P2 (중간)

### 2.4 작업 관리 (FUNC-JOB)

#### FUNC-JOB-001: 작업 큐 관리
- **설명**: 장시간 작업 관리 시스템
- **수락 조건**:
  - 작업 대기열 표시
  - 우선순위 조정
  - 작업 취소/재시도
- **우선순위**: P1 (높음)

#### FUNC-JOB-002: 작업 모니터링
- **설명**: 진행 중인 작업 상태 모니터링
- **수락 조건**:
  - 실시간 진행률 업데이트
  - ETA 예측
  - 오류 로그 표시
- **우선순위**: P1 (높음)

### 2.5 자동화 (FUNC-AUTO)

#### FUNC-AUTO-001: 스케줄링
- **설명**: 정기 작업 스케줄링
- **수락 조건**:
  - Cron 표현식 지원
  - 작업 템플릿
  - 실행 이력 관리
- **우선순위**: P2 (중간)

#### FUNC-AUTO-002: 백업 자동화
- **설명**: 증분 백업 시스템
- **수락 조건**:
  - restic 통합
  - 백업 정책 설정
  - 복원 기능
- **우선순위**: P3 (낮음)

---

## 비기능 요구사항

### 3.1 성능 요구사항 (NFR-PERF)

#### NFR-PERF-001: 응답 시간
- **설명**: UI 응답성 기준
- **기준값**:
  - 페이지 로드: < 2초
  - API 응답: < 500ms (95 percentile)
  - 리모트 목록 렌더링: < 1초 (101개)
- **측정 방법**: Performance API, Lighthouse

#### NFR-PERF-002: 동시성
- **설명**: 동시 작업 처리 능력
- **기준값**:
  - 동시 파일 전송: 10개 이상
  - 동시 사용자: 5명 이상
  - API 동시 호출: 50 req/s
- **측정 방법**: 부하 테스트

#### NFR-PERF-003: 메모리 사용량
- **설명**: 클라이언트 메모리 효율성
- **기준값**:
  - 기본 상태: < 200MB
  - 파일 목록 100만개: < 500MB
  - 메모리 누수: 없음
- **측정 방법**: Chrome DevTools

### 3.2 확장성 요구사항 (NFR-SCALE)

#### NFR-SCALE-001: 데이터 규모
- **설명**: 대량 데이터 처리 능력
- **기준값**:
  - 리모트 수: 200개까지 확장 가능
  - 파일 수: 천만 개 처리 가능
  - 총 용량: 1PB 관리 가능
- **아키텍처**: 가상화, 페이징, 캐싱

#### NFR-SCALE-002: 수평 확장
- **설명**: 서버 확장 가능성
- **기준값**:
  - rproxy 인스턴스: 다중 배포 가능
  - 로드 밸런싱 지원
  - 세션 클러스터링
- **아키텍처**: 무상태 설계

### 3.3 가용성 요구사항 (NFR-AVAIL)

#### NFR-AVAIL-001: 시스템 가용성
- **설명**: 서비스 가용성 목표
- **기준값**:
  - 가용성: 99.9% (월간)
  - 계획된 다운타임: < 4시간/월
  - 복구 시간: < 30분
- **전략**: 자동 재시작, 헬스체크

#### NFR-AVAIL-002: 장애 복구
- **설명**: 장애 처리 능력
- **기준값**:
  - 자동 재연결
  - 작업 재시도 (최대 3회)
  - 데이터 무결성 보장
- **전략**: 트랜잭션, 체크포인트

### 3.4 사용성 요구사항 (NFR-USE)

#### NFR-USE-001: UI/UX 표준
- **설명**: 사용자 인터페이스 기준
- **기준값**:
  - 모바일 반응형 디자인
  - 키보드 단축키 지원
  - 다크/라이트 테마
- **프레임워크**: Mantine UI

#### NFR-USE-002: 접근성
- **설명**: 웹 접근성 표준 준수
- **기준값**:
  - WCAG 2.1 Level AA
  - 스크린 리더 지원
  - 키보드 전용 네비게이션
- **검증**: axe-core

---

## 시스템 인터페이스

### 4.1 외부 시스템 인터페이스

#### 4.1.1 rclone RC API
- **프로토콜**: HTTP/JSON-RPC
- **인증**: Basic Auth
- **엔드포인트**: http://127.0.0.1:5572
- **주요 작업**: 파일 시스템 조작, 리모트 관리

#### 4.1.2 클라우드 스토리지 API
- **대상**: Google Drive, OneDrive, Dropbox 등
- **인증**: OAuth 2.0
- **Rate Limiting**: 서비스별 제한 준수
- **에러 처리**: 지수 백오프

### 4.2 하드웨어 인터페이스
- **최소 요구사항**:
  - CPU: 4 cores
  - RAM: 8GB
  - Storage: 100GB SSD
  - Network: 100Mbps

### 4.3 소프트웨어 인터페이스
- **운영체제**: Linux, macOS, Windows
- **런타임**: Node.js 20+
- **브라우저**: Chrome 120+, Firefox 120+, Safari 17+

---

## 데이터 요구사항

### 5.1 데이터 모델

#### 5.1.1 사용자 데이터
```typescript
interface User {
  id: string;
  username: string;
  email: string;
  role: 'admin' | 'power_user' | 'user';
  createdAt: Date;
  lastLogin: Date;
}
```

#### 5.1.2 리모트 권한
```typescript
interface RemotePermission {
  userId: string;
  remoteId: string;
  permissions: ('read' | 'write' | 'delete')[];
  paths?: string[];  // 경로별 권한 (Phase 2)
}
```

#### 5.1.3 작업 큐
```typescript
interface Job {
  id: string;
  type: 'copy' | 'move' | 'delete' | 'sync';
  status: 'pending' | 'running' | 'completed' | 'failed';
  progress: number;
  source: string;
  destination?: string;
  createdAt: Date;
  startedAt?: Date;
  completedAt?: Date;
  error?: string;
}
```

### 5.2 데이터 저장소

#### 5.2.1 영구 저장소
- **사용자 데이터**: PostgreSQL/SQLite
- **권한 설정**: PostgreSQL/SQLite
- **작업 이력**: PostgreSQL/SQLite
- **캐시**: Redis (옵션)

#### 5.2.2 임시 저장소
- **세션 데이터**: 메모리/Redis
- **진행 중 작업**: 메모리 큐
- **API 응답 캐시**: 메모리 (TTL)

### 5.3 데이터 보존 정책
- **작업 이력**: 30일
- **로그 파일**: 7일
- **세션 데이터**: 24시간
- **캐시 데이터**: 1시간 (조정 가능)

---

## 보안 요구사항

### 6.1 인증 및 권한 (SEC-AUTH)

#### SEC-AUTH-001: 인증 메커니즘
- **방법**: JWT (RS256)
- **토큰 수명**:
  - Access Token: 15분
  - Refresh Token: 7일
- **토큰 저장**: HttpOnly Cookie

#### SEC-AUTH-002: 비밀번호 정책
- **복잡도**:
  - 최소 12자
  - 대소문자, 숫자, 특수문자 포함
- **암호화**: bcrypt (rounds=12)
- **재설정**: 이메일 기반

### 6.2 데이터 보호 (SEC-DATA)

#### SEC-DATA-001: 전송 중 암호화
- **프로토콜**: HTTPS (TLS 1.3)
- **인증서**: Let's Encrypt
- **HSTS**: 활성화

#### SEC-DATA-002: 저장 시 암호화
- **민감 데이터**: AES-256-GCM
- **API 키**: 환경 변수
- **백업 데이터**: 암호화

### 6.3 접근 제어 (SEC-ACCESS)

#### SEC-ACCESS-001: API 보안
- **Rate Limiting**:
  - 인증: 5회/분
  - API: 100회/분/사용자
- **CORS**: 화이트리스트 도메인만
- **CSRF**: 토큰 기반 보호

#### SEC-ACCESS-002: 감사 로깅
- **로깅 대상**:
  - 모든 인증 시도
  - 권한 변경
  - 파일 작업
- **보존 기간**: 90일
- **형식**: JSON 구조화

### 6.4 취약점 관리 (SEC-VULN)

#### SEC-VULN-001: 의존성 관리
- **스캔 주기**: 일일
- **도구**: npm audit, Snyk
- **업데이트 정책**: 보안 패치 즉시 적용

#### SEC-VULN-002: 코드 보안
- **정적 분석**: ESLint security plugin
- **동적 분석**: OWASP ZAP
- **침투 테스트**: 분기별

---

## 제약사항

### 7.1 기술적 제약사항
- **rclone 의존성**: rclone RC API 필수
- **포트 제한**: 5572 포트 사용 (rclone)
- **브라우저 API**: File API, WebWorkers 필요

### 7.2 규제 제약사항
- **GDPR**: EU 사용자 데이터 보호
- **저작권**: 파일 공유 제한
- **API 약관**: 클라우드 서비스 약관 준수

### 7.3 비즈니스 제약사항
- **예산**: 오픈소스 우선
- **타임라인**: 3개월 내 MVP
- **리소스**: 1-2명 개발자

---

## 우선순위 매트릭스

### 8.1 Phase 1 (MVP - 1개월)
| ID | 요구사항 | 중요도 | 긴급도 | 리스크 |
|----|---------|-------|-------|--------|
| FUNC-AUTH-001 | 사용자 인증 | 높음 | 높음 | 낮음 |
| FUNC-AUTH-002 | 권한 제어 | 높음 | 높음 | 중간 |
| FUNC-REMOTE-001 | 리모트 목록 | 높음 | 높음 | 낮음 |
| FUNC-FILE-001 | 파일 브라우징 | 높음 | 높음 | 중간 |

### 8.2 Phase 2 (기본 기능 - 2개월)
| ID | 요구사항 | 중요도 | 긴급도 | 리스크 |
|----|---------|-------|-------|--------|
| FUNC-FILE-002 | 파일 작업 | 높음 | 중간 | 중간 |
| FUNC-JOB-001 | 작업 큐 | 높음 | 중간 | 높음 |
| FUNC-JOB-002 | 작업 모니터링 | 중간 | 중간 | 낮음 |

### 8.3 Phase 3 (고급 기능 - 3개월)
| ID | 요구사항 | 중요도 | 긴급도 | 리스크 |
|----|---------|-------|-------|--------|
| FUNC-FILE-003 | 파일 미리보기 | 중간 | 낮음 | 중간 |
| FUNC-AUTO-001 | 스케줄링 | 중간 | 낮음 | 높음 |
| FUNC-AUTO-002 | 백업 자동화 | 낮음 | 낮음 | 높음 |

### 8.4 위험도 평가

#### 고위험 항목
1. **대용량 파일 목록 처리**: 가상화 필수
2. **동시 작업 관리**: 큐 시스템 복잡도
3. **권한 시스템**: 보안 취약점 가능성

#### 중위험 항목
1. **실시간 업데이트**: SSE vs WebSocket 선택
2. **캐싱 전략**: 일관성 vs 성능
3. **에러 처리**: 다양한 실패 시나리오

#### 저위험 항목
1. **UI 구현**: Mantine 컴포넌트 활용
2. **기본 CRUD**: 표준 패턴 적용
3. **로깅**: 기존 라이브러리 활용

---

## 부록

### A. 용어 정의
- **리모트**: rclone이 관리하는 클라우드 스토리지 연결
- **rproxy**: 보안 프록시 서버 (SvelteKit)
- **rclone rcd**: rclone 원격 제어 데몬
- **작업(Job)**: 비동기로 처리되는 파일 작업

### B. 참조 문서
- rclone RC API 문서
- SvelteKit 공식 문서
- Mantine UI 컴포넌트 가이드
- OWASP 보안 가이드라인

### C. 변경 이력
| 버전 | 날짜 | 변경사항 | 작성자 |
|------|-----|---------|--------|
| 1.0 | 2025-09-24 | 초안 작성 | Claude |

---

**문서 상태**: 검토 대기
**다음 단계**: 기술 아키텍처 설계 문서 작성